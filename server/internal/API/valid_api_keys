package API

import (
	"bufio"
	"fmt"
	"os"
)

// reads API keys from a .txt file and returns them as a map for quick lookups.
func LoadValidApiKeys() (map[string]bool, error) {
	validApiKeys := make(map[string]bool)

	// Open the .txt file
	file, err := os.Open("apikeys.txt") // Update the file path if necessary
	if err != nil {
		return nil, fmt.Errorf("could not open file: %v", err)
	}
	defer file.Close()

	// Create a scanner to read the file line by line
	scanner := bufio.NewScanner(file)
	for scanner.Scan() {
		// Add each API key to the map
		validApiKeys[scanner.Text()] = true
	}

	// Check for any errors encountered while reading the file
	if err := scanner.Err(); err != nil {
		return nil, fmt.Errorf("could not read file: %v", err)
	}

	return validApiKeys, nil
}
